{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-function.js","../src/js/pixabay.js","../src/main.js"],"sourcesContent":["export function createMarkup(photos) {\n  return photos\n    .map(\n      ({\n        tags,\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n            <a href='${largeImageURL}' class=\"card-link js-card-link\">\n            <div class=\"photo-card\">\n              <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n              <div class=\"info\">\n                <div class=\"info-item info-item-likes\">\n                  <div class=\"box-likes\"><b>Likes</b>\n                  <span id=\"value\">${likes}</span>\n                  </div>\n                  \n                </div>\n                <p class=\"info-item\">\n                  <b>Views</b>\n                  ${views}\n                </p>\n                <p class=\"info-item\">\n                  <b>Comments</b>\n                  ${comments}\n                </p>\n                <p class=\"info-item\">\n                  <b>Downloads</b>\n                  ${downloads}\n                </p>\n              </div>\n            </div>\n            </a>`;\n      }\n    )\n    .join('');\n}\n","const API_URL = 'https://pixabay.com/api/';\nconst API_KEY = '40619454-a69b8dffcc7de025c5c5357dd';\n\nexport class PixabayAPI {\n  #page = 1;\n  #per_page = 40;\n  #query = '';\n  #totalPhotos = 0;\n\n  async getPhotos() {\n    const params = {\n      q: this.#query,\n      page: this.#page,\n      per_page: this.#per_page,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    };\n\n    const url = `${API_URL}?key=${API_KEY}`;\n    const queryString = this.objectToQueryString(params);\n    const data = await fetch(`${url}&${queryString}`);\n\n    const dataFetch = await data.json();\n    return dataFetch;\n  }\n\n  get query() {\n    return this.#query;\n  }\n\n  set query(newQuery) {\n    this.#query = newQuery;\n  }\n\n  incrementPage() {\n    this.#page += 1;\n  }\n\n  resetPage() {\n    this.#page = 1;\n  }\n\n  setTotal(total) {\n    this.#totalPhotos = total;\n  }\n\n  objectToQueryString(obj) {\n    return Object.keys(obj)\n      .map(\n        (key) => encodeURIComponent(key) + '=' + encodeURIComponent(obj[key])\n      )\n      .join('&');\n  }\n}\n","import 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { createMarkup } from './js/render-function.js';\nimport { PixabayAPI } from './js/pixabay.js';\nimport SimpleLightbox from 'simplelightbox';\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  searchInput: document.querySelector('.search-form-input'),\n  gallery: document.querySelector('.gallery'),\n  preloader: document.querySelector('.preloader'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nconst pixaby = new PixabayAPI();\nconst lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250 });\n\nwindow.addEventListener('load', () => {\n  console.log('Все ресурсы загружены!');\n});\n\nconst onSubmitClick = async (event) => {\n  event.preventDefault();\n  const searchQuery = event.target.elements.searchQuery;\n  const search_query = searchQuery.value.trim().toLowerCase();\n\n  if (!search_query) {\n    clearPage();\n    iziToast.error({\n      color: 'red',\n      position: 'topRight',\n      message: 'Введите данные для поиска!',\n    });\n    refs.searchInput.placeholder = 'Что ищем?';\n    return;\n  }\n\n  if (search_query === pixaby.query) {\n    iziToast.warning({\n      color: 'yellow',\n      position: 'topRight',\n      message: `Мы уже нашли изображения для \"${search_query.toUpperCase()}\". Пожалуйста, введите другую фразу.`,\n    });\n    return;\n  }\n\n  pixaby.query = search_query;\n  clearPage();\n\n  try {\n    showPreloader();\n    const { hits, totalHits } = await pixaby.getPhotos();\n\n    if (hits.length === 0) {\n      iziToast.error({\n        color: 'red',\n        position: 'topRight',\n        message: `Извините, нет изображений, соответствующих вашему запросу ${search_query}. Пожалуйста, попробуйте снова.`,\n      });\n      return;\n    }\n\n    const markup = createMarkup(hits);\n    refs.gallery.innerHTML = markup;\n    pixaby.setTotal(totalHits);\n\n    lightbox.refresh();\n\n    if (hits.length < totalHits) {\n      showLoadMoreBtn();\n    } else {\n      hideLoadMoreBtn();\n    }\n\n    iziToast.show({\n      color: 'blue',\n      position: 'topRight',\n      message: `Ура! Мы нашли ${totalHits} изображений.`,\n    });\n  } catch (error) {\n    iziToast.error({\n      color: 'red',\n      position: 'topRight',\n      message: `${error.message}. Что-то пошло не так!`,\n    });\n\n    clearPage();\n  } finally {\n    hidePreloader();\n  }\n};\n\nrefs.form.addEventListener('submit', onSubmitClick);\nrefs.loadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nfunction clearPage() {\n  pixaby.resetPage();\n  refs.gallery.innerHTML = '';\n  hideLoadMoreBtn();\n}\n\nfunction showPreloader() {\n  refs.preloader.classList.remove('is-hidden');\n}\n\nfunction hidePreloader() {\n  refs.preloader.classList.add('is-hidden');\n}\n\nfunction showLoadMoreBtn() {\n  refs.loadMoreBtn.classList.remove('is-hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  refs.loadMoreBtn.classList.add('is-hidden');\n}\n\nasync function onLoadMoreClick() {\n  try {\n    showPreloader();\n    const { hits } = await pixaby.getPhotos();\n\n    const markup = createMarkup(hits);\n    refs.gallery.innerHTML += markup; \n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      color: 'red',\n      position: 'topRight',\n      message: `${error.message}. Не удалось загрузить больше изображений.`,\n    });\n  } finally {\n    hidePreloader();\n  }\n}\n"],"names":["createMarkup","photos","tags","webformatURL","largeImageURL","likes","views","comments","downloads","API_URL","API_KEY","PixabayAPI","__privateAdd","_page","_per_page","_query","_totalPhotos","params","__privateGet","url","queryString","newQuery","__privateSet","total","obj","key","refs","pixaby","lightbox","SimpleLightbox","onSubmitClick","event","search_query","clearPage","iziToast","showPreloader","hits","totalHits","markup","showLoadMoreBtn","hideLoadMoreBtn","error","hidePreloader","onLoadMoreClick"],"mappings":"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"}